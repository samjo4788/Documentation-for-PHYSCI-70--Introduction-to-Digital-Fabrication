<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Theme Made By www.w3schools.com - No Copyright -->
  <title>SamJo/physci70</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="../style.css"/>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="../index.html">SamJo/ps70</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://samjo4788.github.io/PHYSCI-70/About/indexA.html">ABOUT</a></li>
        <li><a href="https://samjo4788.github.io/PHYSCI-70/FinalProject/indexFP.html">FINAL PROJECT</a></li>
        <li><a href="https://nathanmelenbrink.github.io/ps70/index.html">COURSE SITE</a></li>
        <!--         <li><a href="#">WHERE</a></li> -->
      </ul>
    </div>
  </div>
</nav>

<!-- First Container -->
<!-- <div class="container-fluid bg-1 text-center">
  <h3 class="margin">Physci 70</h3>
  <p>Welcome to my site for ps70 Spring 2021, where I will document my work throughout the semester. </p>
<img src="bird.jpg" class="img-responsive img-circle margin" style="display:inline" alt="Bird" width="350" height="350">
</div> -->

<!-- Second Container -->
<div class="container-fluid2 bg-9 text-center">
  <p><b>Week 07: Electronic Output Devices</b></p>
 <!--  <a href="#" class="btn btn-default btn-lg">
    <span class="glyphicon glyphicon-search"></span> Search
  </a> -->
</div>

<!-- Third Container (Grid) -->
<div class="container-fluid bg-7">
<div class="row">
  <div class="col-sm-3">
    <p><b>Close Encounters</b></p>
    </div>
  <div class="col-sm-9">
    <p>This week I was inspired by the classic movie <i>Close Encounters of the Third Kind</i>. I wanted to reproduce the five-tone sequence that the aliens use to communicate with the humans in the film, using my accelerometer as the input device and the piezo buzzer as the output device. The five-tone sequence is D5 - E5 - C5 - C4 - G4 or RE - MI - DO - DO - SO in solfege.</p>
    <div class="row">
      <div class="col-sm-6">
        <p><iframe width="100%" height="394" src="https://musescore.com/user/37911554/scores/6671317/s/vPMn_l/embed" frameborder="0" allowfullscreen allow="autoplay; fullscreen"></iframe>
        <span><a href="https://musescore.com/user/37911554/scores/6671317/s/cNJO9V" target="_blank">Close Encounters Sequence</a> by <a href="https://musescore.com/user/37911554">samjo4788</a></span></p>
        </div>
      <div class="col-sm-6">
        <p><img src="kodalyhand-rows.png" class="img-responsive margin" style="width:100%" alt="Solfege Hand Signs">Solfege Hand Signs</p>
      </div>
      </div>
      <p><iframe width="560" height="315" src="https://www.youtube.com/embed/_yIp2huYgD8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
    </div>
  </div>


<div class="container-fluid bg-7">    
<!--   <h3 class="margin">Weekly Work</h3><br> -->
  <div class="row">
    <div class="col-sm-3">
      <p><b>TFT Display</b></p>
      <br>
      <iframe width="250" height="315" src="https://www.youtube.com/embed/gzAkAWvb8Ug" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      
    </div>
    <div class="col-sm-9"> 
      <p>In labs we learned how to set up the TFT Display. I decided to continue with this as my output device, displaying positional information from the accelerometer. My plan is to attach the accelerometer to a glove and have the TFT display indicate solfege based on the position of my hand (the accelerometer). If I can do this, then I’ll also try and add a piezo buzzer with the goal of playing the 5-tone sequence from Close Encounters of the Third Kind. I was really inspired by this tone sequence actually, and realized that the solfege equivalents of the tones could be distinct enough for an accelerometer to read. We’ll see.</p>
      <p>I started with my TFT Display wiring set up (see notes from Slack). And I worked through some of the tutorials on the adafruit site to get comfortable with programming the TFT to display things other than the demo. I took the code from the TFT set up demo and cleaned it up, removing all the commented out lines for other TFT displays. Because I really wanted to spend time getting the microcontroller to read the inputs from the accelerometer to produce a basic text output on the TFT, I didn’t get too involved in all the options a TFT Display can provide.</p>
      <p>I got the TFT display to read “Do” “Re” and “Mi” by modifying the demo code. </p>
        <p><pre><code class="language-arduino">
          void loop() {
          tft.fillScreen(ST77XX_BLACK);
          testdrawtext("DO", ST77XX_GREEN);
          delay(4000);


          tft.fillScreen(ST77XX_BLACK);
          testdrawtext("RE", ST77XX_YELLOW);
          delay(4000);


          tft.fillScreen(ST77XX_BLACK);
          testdrawtext("MI", ST77XX_MAGENTA);
          delay(4000);

          Serial.println("done");
          delay(1000);
          }
        </code></pre></p>

        <p>Next I moved on to the accelerometer to figure out what the input data would be to produce the right outputs. 
  </div>

</div>
<div class="container-fluid bg-7">
<div class="row">
  <div class="col-sm-3">
    <p><b>Accelerometer</b></p>
    <br>
      <img src="Setup_TFT.jpg" class="img-responsive margin" style="width:100%" alt="an accelerometer is attached to a glove and wired to a TFT display via a microcontroller">
    </div>
  <div class="col-sm-9">
    <p>I wired up my accelerometer the way I had set it up for that silly calibration test, except this time the breadboard is attached to the back of a glove. I used my code from the previous week as well to get a sense of the different x, y, and z values for each solfege positions: do, re, mi, and so. I also needed to come up with a way to distinguish low do from high do, as well as to figure out a way to distinguish do and re, which conventionally would have the same planar coordinates.</p>
    <p>After collecting some data, I made the following determinations for x,y,z values/ranges:<br>
      when Z > 9 and x < 1 and y < 1, print “DO - low”<br>
      when Z > 9 and x > 1 and y > 1 print “DO-high”<br>
      when z < 9 and X < 1 and y > 1 print “RE”<br>
      when Z < 9 and X > 4 and Y > 1 print “MI”<br>
      when Z < 1 and X < 1 and Y > 8 print “SO”<br></p>
    <p>Using if...else functions, I set the Serial Monitor to print the appropriate solfege term when the above conditions were met. At first, it seemed to work, except that "RE" popped up more often than it should have. Also, "SO" was just not happening. I tweaked the values so they were narrower, but this didn't seem to help. I ended up abandoning my attempts at capturing actual solfege hand signs that relied upon 3 different variables, and instead wrote code that measured extreme hand positions and needed only one variable to make an output determination. The variable in question would equal measure of gravity 9.6m/s2. To account for error, I made each variable greater than +8 or less than -8. I also added in a position that would be guaranteed to be silent.<br>

      flat hand = DO high = Z > 8 <br>
      hand pointed upward = MI = X > 8 <br>
      hand sideways, palm in = SO = Y > 8 <br>
      hand sideways, palm out = DO low = Y < -8 <br>
      hand pointed downward = RE = X < -8 <br>
      palm up = rest (silence) = Z < -8 <br></p>

   <p>I then attempted to combine my accelerometer code and my TFT code by copy and pasting, and inputing my TFT display preferences into my if...else if statements. Unfortunately, my TFT display wouldn't turn on, and I was getting lost in the code. I decided that I would need to spend more time than I had this week on figuring out how to make the code pieces play nice, and so I decided to incorporate the piezo buzzer and leave the TFT display behind.</p>

</div>

</div>

<div class="container-fluid bg-7">
<div class="row">
  <div class="col-sm-3">
    <p><b>Piezo Buzzer</b></p>
      <img src="Setup_Buzzer.jpg" class="img-responsive margin" style="width:100%" alt="an accelerometer is attached to a glove and wired to a Piezo Buzzer via a microcontroller">
      <br>
      <iframe width="250" height="315" src="https://www.youtube.com/embed/v8CUzEKj4_k" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
  <div class="col-sm-9">
    <p>Using the piezo buzzer as an output device for the accelerometer proved to be very simple. I pulled the basic piezo buzzer code with the tone() function off of the class website's piezo buzzer page, and pasted it into my accelerometer code. I used <a href="https://pages.mtu.edu/~suits/notefreqs.html">this guide to musical note frequencies</a> (also from our class site) to find the appropriate Hz values for each tone in the sequence:<br>
      DO high = c5 = 523.25<br>
      DO low = c4 = 261.63<br>
      RE = d5 = 587.33<br>
      MI = e5 = 659.25<br>
      SO = g4 = 392.00<br>
    </p>
    <p>MAGIC</p>
    
    <p><pre><code class="language-arduino">

#include <Wire.h>
#include <SPI.h>
#include <Adafruit_LIS3DH.h>
#include <Adafruit_Sensor.h>
#define LIS3DH_CS 10

int buzzerPin = 10;

Adafruit_LIS3DH lis = Adafruit_LIS3DH();

void setup(void) {
  pinMode(buzzerPin, OUTPUT);
  Serial.begin(115200);
  
  }
}

void loop() {
  sensors_event_t event;
  lis.getEvent(&event);

  // if hand is flat
  if (event.acceleration.z > 8) {
    tone(buzzerPin, 523.25, 500);
    Serial.print("DO HIGH");
  }
  
  //if hand is pointed upward
  else if (event.acceleration.x > 8) {
    tone(buzzerPin, 659.25, 500);
    Serial.print("MI");
  }

  // if hand is sideways, palm in
  else if (event.acceleration.y > 8) {
    tone(buzzerPin, 392.00, 500);
    Serial.print("SO");
  }

  //if hand is sideways palm out
  else if (event.acceleration.y < -8) {
    tone(buzzerPin, 261.63, 500);
    Serial.print("DO low");
  }

  //if hand is pointed downward
  else if (event.acceleration.x < -8) {
    tone(buzzerPin, 587.33, 500);
    Serial.print("RE");
  }

  // if palm is up
  else if (event.acceleration.z <-8) {
    tone(buzzerPin, 0, 500);
    Serial.print("rest");
  }

  Serial.println();

  delay(2000);
}
</code></pre></p>
      </div>


</div>
</div>
 
    </div>
  </div>
</div>

</body>
    

<!-- Footer -->
<footer class="container-fluid bg-4 text-center">
  <p>Bootstrap Theme Made By <a href="https://www.w3schools.com">www.w3schools.com</a></p> 
</footer>

</body>
</html>
