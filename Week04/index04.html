<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Theme Made By www.w3schools.com - No Copyright -->
  <title>SamJo/physci70</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="../style.css"/>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="../index.html">SamJo/ps70</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://samjo4788.github.io/PHYSCI-70/About/indexA.html">ABOUT</a></li>
        <li><a href="https://samjo4788.github.io/PHYSCI-70/FinalProject/indexFP.html">FINAL PROJECT</a></li>
        <li><a href="https://nathanmelenbrink.github.io/ps70/index.html">COURSE SITE</a></li>
        <!--         <li><a href="#">WHERE</a></li> -->
      </ul>
    </div>
  </div>
</nav>

<!-- First Container -->
<!-- <div class="container-fluid bg-1 text-center">
  <h3 class="margin">Physci 70</h3>
  <p>Welcome to my site for ps70 Spring 2021, where I will document my work throughout the semester. </p>
<img src="bird.jpg" class="img-responsive img-circle margin" style="display:inline" alt="Bird" width="350" height="350">
</div> -->

<!-- Second Container -->
<div class="container-fluid2 bg-9 text-center">
  <p><b>Week 04: Microcontroller Programming</b></p>
 <!--  <a href="#" class="btn btn-default btn-lg">
    <span class="glyphicon glyphicon-search"></span> Search
  </a> -->
</div>

<!-- Third Container (Grid) -->
<div class="container-fluid bg-7">    
<!--   <h3 class="margin">Weekly Work</h3><br> -->
  <div class="row">
    <div class="col-sm-3">
      <p><b>The Idea</b></p>
      <br>
      <p style="font-size:75%""><i>Here's a creepy pager commercial from the 90s</i><br>
        <iframe width="270" height="150" src="https://www.youtube.com/embed/jrUVYTqvIfI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></P>
      <!-- <img src="birds1.jpg" class="img-responsive margin" style="width:100%" alt="Image"> -->
    </div>
    <div class="col-sm-9"> 
      <p>For this week’s assignment I considered building on Week 3, but I realized that what I would want to program with Arduino would be simple compared to the amount of work I would need to do to reconstruct the movement mechanism for the kinetic sculpture. So, I decided to go in a different direction.</p>
      <p>My husband had been asking me for an “on air” switch that we could use to let the other person know when we were on a zoom call (our desks abut one another in our tiny apartment). This also, really did not require any programming. So instead he suggested a pager, so I could indicate to him when I needed something based on different LED patterns. I thought it would be cool to add an “urgency” indicator, where the speed of the blinking LEDs would increase or decrease based on adjustments made to a potentiometer.</p>
      <p>I’m curious if I can use the piezo sensor as a kind of button, to indicate when the lights should come on or off, and which lights should illuminate.
      </p>

      <!-- <img src="birds2.jpg" class="img-responsive margin" style="width:100%" alt="Image"> -->
    </div>
  </div>
<div class="row">
  <div class="col-sm-3">
    <p><b>The Basic LED Blinking Circuit</b>
      <br>
      <br>
      <iframe src="https://giphy.com/embed/XmWzjdJsSJVj0YsIRu" width="270" height="300" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/XmWzjdJsSJVj0YsIRu">via GIPHY</a></p>
    </p>
      <!-- <img src="birds1.jpg" class="img-responsive margin" style="width:100%" alt="Image"> -->
    </div>
    <br>
  <div class="col-sm-9">
    <p>First, I decided I’d figure out how to control the blink of a single LED with a pot. I knew that the value of the potentiometer would be controlling the value of the delay between commands to turn the LED on and off. The LED commands would be digitalWrite() functions but the pot would be using an analogRead() function. This actually turned out to be very simple. After perusing the beginning of the Arduino Project Book and doing some Arduino googling, I found some <a href="https://www.arduino.cc/en/tutorial/potentiometer">basic code for linking a pot to the speed of the LED blink.</a></p>
    <p>I made a simple LED circuit using a 470 Ohm resistor to start and was able to successfully get my LED to blink.</p>
    </div>
  </div>
  <br>
  <div class="row">
  <div class="col-sm-3">
    <p><b>Adding the Pot</b>
      <br>
      <br>
      <iframe width="270" height="150" src="https://www.youtube.com/embed/jYDeGwNNuHQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </p>
      <!-- <img src="birds1.jpg" class="img-responsive margin" style="width:100%" alt="Image"> -->
    </div>
  <div class="col-sm-9">
    <p>Now to incorporate the potentiometer. I took a look at the example code for controlling a motor with a pot and followed some of those directions for the microcontroller and board set up. I then borrowed the setup commands for the pot and then changed the formula to be about the delay. And it worked!
    <br>
    <pre><code class="language-arduino">
int led = 13; // the pin the LED is connected to

void setup() {
  pinMode(led, OUTPUT); // Declare the LED as an output
  pinMode(A0, OUTPUT);  //This will be GND for the potentiometer
  pinMode(A4, OUTPUT);  //This will be 3.3V for the pot.
  digitalWrite(A0, LOW);
  digitalWrite(A4, HIGH);
  digitalWrite(led, LOW); // start with the LED off
}

void loop() {
  int pot_value = analogRead(A2); // pot wiper is on A2
  int delay_level = map(pot_value, 0, 1023, 2000, 0); // map motor level to delay period
  digitalWrite(led, HIGH); // Turn the LED on
  delay(delay_level); // wait for a time dependent on the pot level
  digitalWrite(led, LOW); //Turn the LED off
  delay(delay_level); // wait for a time dependent on the pot level
}
}
    </code></pre>
    </p>
    </div>
  </div>
    <div class="row">
  <div class="col-sm-3">
    <p><b>Adding more LEDs</b>
      <br></p>
      <!-- <img src="birds1.jpg" class="img-responsive margin" style="width:100%" alt="Image"> -->
    </div>
  <div class="col-sm-9">
    <p>Now I set up three different LEDs and connected them to three different buttons. This worked without changing any code at all.</p>
    <p><iframe src="https://giphy.com/embed/JWuMweaYW2GqiXxPD8" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/JWuMweaYW2GqiXxPD8">via GIPHY</a></p>
    <br>
    </div>
  </div>
  <div class="col-sm-3">
    <p><b>The Piezo Disc</b></p>
    <p><img src="PiezoSetup.jpg" class="img-responsive margin" style="width:100%" alt="Image"></p>
    <p><img src="LEDSetUp.jpg" class="img-responsive margin" style="width:100%" alt="Image"></p>
    <p><img src="MetroSetUp.jpg" class="img-responsive margin" style="width:100%" alt="Image"></p>
    </div>

  <div class="col-sm-9">
    <p>This last step proved to be the most difficult. I wanted to try and use a Piezo disc instead of buttons to control which LEDs turned on. First I set up each of my LEDs onto different pins. <br>
<pre><code class="language-arduino">
const int piezoSensor = A5; // analog pin in piezo is connected to
int sensorReading = 0; //variable to store value read from sensor
int led = 13; // the pin the LED is connected to

void setup() {
  pinMode(led, OUTPUT); // Declare the LED as an output
  pinMode(A0, OUTPUT);  //This will be GND for the potentiometer
  pinMode(A4, OUTPUT);  //This will be 3.3V for the pot.
  digitalWrite(A0, LOW);
  digitalWrite(A4, HIGH);
  digitalWrite(led, LOW); // start with the LED off
  Serial.begin(9600); //start serial monitor window
}

void loop() {
  sensorReading = analogRead(piezoSensor);
  Serial.println(sensorReading);
  if(sensorReading > 0 && sensorReading <=100) {
  int pot_value = analogRead(A2); // pot wiper is on A2
  int delay_level = map(pot_value, 0, 1023, 2000, 0); // map motor level to delay period
  digitalWrite(led, HIGH); // Turn the LED on
  delay(delay_level); // wait for a time dependent on the pot level
  digitalWrite(led, LOW); //Turn the LED off
  delay(delay_level); // wait for a time dependent on the pot level

  delay(10);
  }

  else {
    digitalWrite(led, LOW); //Turn LED off

    delay(10);
  }
}
</code></pre>
    <p>I explored a few different tutorials including this one for <a href="https://www.arduino.cc/en/Tutorial/BuiltInExamples/Knock">basic Knock sensing</a> and <a href="https://www.sensingthecity.com/vibrations-to-light-use-a-piezo-element-to-control-an-led-strip/">this code for controlling an LED strip with a piezo disc</a>. I was already using my A0-A4 pins for the pot, so I used the A5 pin for my piezo disc along with a 1M ohm resistor. At first, I set this up wrong. (Later, I realized this and added a diode. I wrote the code to respond to different thresholds of vibration.</p>
    <p>This seemed to work but the piezo sensor was very very sensitive...so I tried modifying the thresholds and that sort of worked a little better. (note in the video below, my piezo sensor is hooked up strangely.... I later adjusted this based on the tutorial I mentioned above.)</p>
    <p><iframe width="560" height="315" src="https://www.youtube.com/embed/Gux3PHDmYaM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
    <p>I still wanted to incorporate a sequence of knocks however to signal which LED should turn on. I used a combination of code from this <a href="https://www.programmingelectronics.com/how-to-make-a-secret-knock-detector-to-trigger-anything-with-only-an-arduino-and-a-few-cheap-components/">secret knock tutorial</a> and this <a href="https://www.instructables.com/Aruidno-LED-Knock-Puzzle/">LED knock puzzle tutorial.</a> The code was starting to get complicated and though I think I finally figured out the correct commands...it wasn't translating into the circuit. I then tried to go back and retest my original threshold code and that didn't work either, which is drawing me to conclude that I may have damaged my piezo sensor? ::crying:: </p>
    <p><a href="./LEDPiezoBlink_Thresholds">Download my code with thresholds</a></p>
    <p><a href="LEDPiezoBlink_KnockSequence">Download my code for knock sequences</a></p>

    </p>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="container-fluid bg-4 text-center">
  <p>Bootstrap Theme Made By <a href="https://www.w3schools.com">www.w3schools.com</a></p> 
</footer>

</body>
</html>
