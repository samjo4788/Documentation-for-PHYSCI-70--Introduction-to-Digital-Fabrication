<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Theme Made By www.w3schools.com - No Copyright -->
  <title>SamJo/physci70</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="../style.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="../index.html">HOME</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://samjo4788.github.io/PHYSCI-70/About/indexA.html">ABOUT</a></li>
        <li><a href="https://samjo4788.github.io/PHYSCI-70/FinalProject/indexFP.html">FINAL PROJECT</a></li>
        <li><a href="https://nathanmelenbrink.github.io/ps70/index.html">COURSE SITE</a></li>
        <!--         <li><a href="#">WHERE</a></li> -->
      </ul>
    </div>
  </div>
</nav>


<!-- TITLE Container -->
<div class="container-fluid2 bg-9 text-center">
  <p><H3><b>FINAL PROJECT:</b></H3></p>
    <p><h3><b>DanceGlove</b></H3></p>
 <!--  <a href="#" class="btn btn-default btn-lg">
    <span class="glyphicon glyphicon-search"></span> Search
  </a> -->
</div>

<!-- INTRODUCTION -->
<div class="container-fluid bg-7 text-center">
  <p>My final project relates directly to my dissertation research on Irish dancers and the unique (and very musical) ways that they learn, remember, and communicate their dance steps. One technique that dancers use is hand dancing: dancers use their hands or fingers to mimic complex footwork choreography. The goal of this project was to create a pair of gloves that would collect movement information that could then be analyzed and manipulated to examine parameters such as rhythmicity, style, and which could be visualized in a way that can communicate this movement behavior independent of the use of video. The DanceGlove measures whole hand movements and proximity between the left and right hands (using IMU and Photoresistive sensors), and it also measures fine motor movements of the index and middle fingers on the right hand (using flex sensors and a circuit switch).</p>
  <div class="row">
    <div class="col-md-6">
  <p><iframe width="560" height="315" src="https://www.youtube.com/embed/pkDFMg0sEoE" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
    </div>
    <div class="col-md-6">

      <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
      <div class="pa-gallery-player-widget" style="width:100%; height:315px; display:none;"
      data-link="https://photos.app.goo.gl/nGqSDrJaXtjBiyQt5"
      data-title="ps70 - Final Prototype"
      data-description="7 new photos added to shared album">
      <object data="https://lh3.googleusercontent.com/8XnjOoMsE3BvXgAuiX139oNFIRPAQ79qB-vkHgni1JwEzj2clV40LGesAxiJslDjGdiQ_FZum9vbrfbSmQJZ8-uj50oYYMmcnliaHfm3bcOwbnuCRR7cFlv_LTpL-zoTa_j-7PcSmbE=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/CUL81NWjmL9EJqoBqjD-SqSxV2yJDMMVt_Fa-vhDe3adTdbL5SLMsQMQ3sCjcC3zWz-mZaH8OCjYpwYi22XFWtBlN4wN2rCPPcgBWhC1erv-g4uMxoOpzIbT8GB8AswQeBRAfndxjZc=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/fLgORCw4e6ZN8K8wbG3Qt25_A0oaBL59uPvD_1NjHNHtPgnub-WT7VUC7RgvR3-TS__A9Di6S6ukqzOIK41a-VugZoHbijRuAtSnMtTPrB7H0b5tSTKOmsVESfng55EdIUTzQVyWFRo=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/5uqcgBs-ZR9VVsx5fNGOquKgX38HCihW3ScnpQbZJcV2l6yKdxeYld62thliqAGaAkyNzyXH1GO8vohZF9ITonB5JuODVnda60L9rmi0OS5Gh5wG247waLWObzPs_cvtNiRZSUAlOkY=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/LXrkbp8RCtK_qSOCmEgl7MknYHh7gH0NJXsw-Tbeh9sAH79sz32FLUe7Y5J_TS-GobKyK1QT3o0j71E1CJA66IjQGvOYZtxeJn6fwLSbZIedGIf3MPqkO1cQlAW-sZdgvgI-vMwQ3X8=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/pUe3CaRtNvqYCSFmv8fBDk2fhUtRm8oPd2aqLZDq0D6kuSkceI9TzzH5kM0-85k3j1_FnUfRH5yv6G9xRsUBhOFivyaHvcLBslXHaAsKUAJgKhuhatjEcdFeR0NARnRrrgrpcRscPpE=w1920-h1080"></object>
      <object data="https://lh3.googleusercontent.com/-AjtSseWxUPaNHrD09alE-2EeV8eBlxtGRLSIf8-Jqty59oL_sPJGckKRJD-aYliICsrV3BNU-Wdahvc-P5SHXdn8v89smrUYXOdduOKXDuKxjbpC4FHHFzjYxnwlmypk4xFkK8B4Ww=w1920-h1080"></object>
    </div>
    

  </div>
</div>
  <br>


  <p><h3>HAND DANCE MODE</h3></p>
  <div class="row text-center">
    <p>The gloves use IMU and proximity sensors to measure movement information. Within the code, I wrapped the accelerometer and gyroscope data into a Madgwick filter so that it would produce values for pitch, yaw, and roll. I then analyzed this output for patterns. For both the right and left hands, the yaw data was mostly noise. This is not surprising as both hands stay pointed in mostly the same direction throughout a dance. The pitch information yielded the most obvious visual patterns, with the roll acting almost like a shadow to the pitch. </p>
    <p><iframe width="1011" height="371" seamless frameborder="0" scrolling="no" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTVPpi1dzZWKcqDNf20a_4xfSoLqGysIEHHYhCQETUNlyXm8XHwa-qT4DwJJLJ-yBSA8CT83LCYCbce/pubchart?oid=1684965289&amp;format=interactive"></iframe></p>
    </div>
  <BR>

<div class="row text-center">
  <p><h3>FINGER DANCE MODE</h3></p>

  <p>I used a basic switch-based circuit to sense when the index finger and middle finger made contact with the thumb. I also used flex sensors that covered the joints of each of these fingers. This data was a little more unwieldy than the IMU data. I believe that this information would be best parsed by a machine learning program. Nevertheless, I pursued some rudimentary visualizations in p5 to see if I could gain any interesting insights. While it was fun to play around with different triangles, the real-time graphic changes were not particularly informative.</p>
  <p><iframe width="560" height="315" src="https://www.youtube.com/embed/tXLkW-TMJLw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>
</div>
</div>


<div class="container-fluid2 bg-9 text-center">
  <p><h3><b>HOW IT'S MADE</b></h3></p>
</div>

<!-- MATERIALS & SKILLS-->
<div class="container-fluid bg-7">
  <p><h3><b>MATERIALS & SKILLS</b></h3></p>
  <p>When appropriate, specific techniques are hyperlinked to tutorials. To create this project, you will need to crochet or embroider basic stitches, hand sew, use a sewing machine (though you could substitute hand sewing if you are patient), solder electronics, and follow along some basic circuitry and programming.</p>
<div class="row">
  <div class="col-sm-6">
  <p>SAFETEY FIRST!</p>
    <ul>
      <li>Protective Goggles</li>
      <li>Protective Gloves</li>
      <li>Bandaids for the inevitable pierce of a sewing needle.</li>
    </ul>

  <p>SEWING MATERIALS & TOOLS
      <ul>
        <li>Cotton fabric (36 cm square)</li>
        <li>Stretch (knit/lycra) fabric (approximately 0.5 yard)</li>
        <li>Felt or thin quilting batting (15 cm square)</li>
        <li>Cotton thread</li>
        <li>Velcro</li>
        <li>Sewing Machine</li>
        <li>Needles & Pins</li>
        <li>Scissors</li>
        <li>Rotary Cutter</li>
        <li>Quilting Mat & Ruler</li>
        <li>Iron</li>
        <li>Ironing Board</li>
        <li>Thimble</li>
        </ul></p>
    </div>

    <div class="col-sm-6">
    
<p>ELECTRONICS
      <ul>
        <li>Whole-Hand Sensing</li>
        <ul>
          <li><a href="https://store.arduino.cc/usa/nano-33-ble-sense">2 x Arduino Nano 33 BLE Sense</a></li>
        </ul>
        <li>Finger Tap Sensing (2 fingers)</li>
          <ul>
          <li>1 x 1k Ohm Resistor</li>
          <li>1 x 4.7k Ohm Resistor</li>
          <li>1 x 10k Ohm Resistor</li>
          <li>Solid Core Wire (30 AWG)</li>
          </ul>
        <li>Finger Joint Sensing (2 fingers)</li>
          <ul>
          <li><a href="https://www.adafruit.com/product/1361">Velostat</a></li>
          <li>Aluminum Foil</li>
          <li>2 x 1k Ohm Resistors</li>
          <li>Solid Core Wire (30 AWG)</li>
          <li><a href="https://www.adafruit.com/product/640">Conductive Thread, 2-ply</a></li>
          <li><a href="https://www.homedepot.com/p/3M-1-88-in-x-54-6-yds-Black-Premium-Matte-Cloth-Gaffers-Tape-GT2/302798748">Gaffer Tape</a></li>
          </ul>
        <li>Tools & Supplies</li>
        <ul>
          <li>Multimeter</li>
          <li>Soldering Iron & Solder</li>
          <li>Wire Trimmers</li>
          <li>Heat Shrink and/or Electrical Tape</li>
          <li>Needle Nose Pliers</li>
        </ul>
        </ul></p>
  
  </div>
</div>

</div>

<!-- FABRCIATION --- SEWING -->
<div class="container-fluid bg-2">
<p><h4><b>SEWING THE GLOVE</b></h4></p>
<div class="row">
  <div class="col-sm-3">
    <p>PATTERN & GLOVE</p>
    </div>
  <div class="col-sm-9">
    <p>Follow <a href="https://samjo4788.github.io/PHYSCI-70/FinalProject/GlovePattern/indexPattern.html">this method for making patterns and constructing gloves</a> for the right and left hands. Or, buy gloves. If you do the latter, you’ll need to attach two channels of elastic fabric to the index and middle fingers of the right hand.</p>
  </div>
</div>
<BR>

<div class="row">
  <div class="col-sm-3">
    <p>SEW THE FINGER PADS</p>
    </div>
  <div class="col-sm-9">
    <div class="row">
      <div class="col-sm-6">
        <p>On the right hand glove only there are three finger pads. Put on your glove and hold the index and middle fingers against the thumb in a pinching fashion. Note where the fingers touch. Mark these with a piece of tape and remove the glove.</p>
        <p>There are many ways to create finger pads. <a href="https://www.instructables.com/Etextile-VR-Gloves-for-Vive-Tracker/">This tutorial</a> is useful if you want to make finger pads from conductive fabric. My method will explain how to do this using crochet and embroidery of conductive thread. In both cases, the finger pads will be attached to the glove as appliqué.</p>
        </div>
      <div class="col-sm-6">
        <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
          <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
          data-link="https://photos.app.goo.gl/xWeFhpFeSrztAaDs5"
          data-title="ps70 - Finger Pads"
          data-description="6 new photos added to shared album">
          <object data="https://lh3.googleusercontent.com/2uWZ12mUezH4mllnm7Slu612qxZ76M6TSS9DAWSm7XFzaVZB5fYpRj7EUi_7PKQZh3t2R_RmLJ2GMFDyyiDOe4I0LoaAANdTWq-aE78j4iWd9GZW9tG0w1OegXeO4wiwgrULvTtcGNQ=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/ZOkzd2Qq2IW_GcvByx9VFYPB3QXNW-binyKq5LlYMt4Ag7PD9h5L91PuaZO0_HV6lCFZ6Bluk2AWWzLxIODtwwAYa_1g1leSjUE70qnyX-1-cID5BtQeQwjf3KPWaJPo0yzhwo1sB08=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/43Os3gnPwT3n9z0Rt6MjDWDlI10f_P1rxddr4Noqq6ENaaj5-MI8q-JUx5ti3LpqxjaWzTWCBr-eDIwsLAtjPn1QQIJvz76Y4187ksCyuWOSIStH9YzMyXA8cvPbg7uqKYaK9uX93r8=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/7JDJATcFTiGEQcz8sQnuL6s8JzPfwYbkQAmqTBH0m4vFEemAE1X5tJ_6SH3kapQ232spsl0wIqzx5ZWohMHno9q6VShYnkMMIu9DI7Qquj0WCA4h7tzOP5EK5gCes_VW6fbfSWSdjIk=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/D5XxFTMrdNhxTRxxiandcBBNoxw-LaqQPgE978pYBxCVcoYUQGpY2dKmJJUWDphbrv4JcvToPWnamijDLK_kfprtq19O-XgTXda9o4cShSJy8K0IiXF98leSuc1JFmP4LFjnBlyUqEM=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/e6wx-gTvbi-aAC4YjJrrU3eqReqzSOYaglGUgWVfVBVTKrc6iKqXTA-cVzt6Gg_IHf9xMHMyyezNrqpbAcb19g0lc3C0YKhiOZ7AdHw7yek48yYdBe5Yvxc0N2f16xeEonoCZwyScQY=w1920-h1080"></object>
        </div>
      </div>
    </div>

  
    <p>Crochet the two finger pads:<ul>
      <li>These two pads are smaller than the thumb. You will create each the same, so do this twice. Using 2-ply conductive thread, draw a length of thread and quadruple it. Take the four strands of thread and loosely spin them together. This will serve as your “yarn”. With a crochet hook, crochet a <a href="https://www.youtube.com/watch?v=_yNj1ZGy0PA">magic loop</a> of 7 stitches and then single crochet 1 round. Add rounds if you need a larger finger pad. Finish by pulling the strand through the last loop and using a needle to weave in the ends. Trim. Note: Cut conductive thread with sharp scissors to mitigate fraying.</li>
      </ul></p>

    <p>Embroider the thumb pad:<ul>
        <li>Because the thumb pad is larger than the finger pads, it was easier for me to embroider the pad. Using a scrap piece of cotton fabric that is larger than what you need for the finger pad, trace the size of the finger pad you need to cover the thumb with a pencil on the fabric. This will be your guide for the shape of the finger pad. I recommend this be a rectangular shape to be sure that it meets both the index and middle finger, with room for moving about (your fingers won’t hit your thumb in the same place every time). Starting on the left side, embroider a row of stitches using the <a href="https://youtu.be/HjoODQJiwk0">satin stitch</a>, then continue in the other direction to make a second row. Repeat this until you have four rows, or the number of rows you need to cover the area of the finger pad (you’ll see my satin stitches aren’t particularly neat or the same size, but that doesn’t matter as long as they touch and cover the area). When the area of the pad is covered, sew into the satin stitch and trim the tail. Trim the cotton fabric around the finger pad. It may fray a bit, but don’t worry. </li></ul></p>

    <p>Appliqué the finger pads:<ul>
        <li>Replace the tape that you attached to your glove with the appropriate finger pad and hold in place with a pin or two. Insert a thimble into the finger tip you plan to sew and use that to push the needle against. Attach the finger pad to the finger tip using the satin stitch, stitching the edge of the finger pad to the glove fabric. Do this for each of the two finger pads and the thumb pad.</li></ul></p>

    

  </div>
</div>

<BR>

<div class="row">
  <div class="col-sm-3">
    <p>CREATE THE MICROCONTROLLER BASES</p>
    </div>
  <div class="col-sm-9">
    <p>I did not want to sew a microcontroller directly onto a relatively thin and stretchy glove for multiple reasons. First, the fabric stretches and so not only could the microcontroller put a strain on the fabric itself, but it would also likely move around with the glove. Second, I wanted a little cushion between the soldered ends of the microcontroller and the back of my hand. Using a non-stretch cotton fabric with a felt liner created a stable and durable base for the microcontroller. </p>
    <div class="row">
      <div class="col-sm-6">
    <p>Create the fabric base:<ol>
      <li>Cut four 5.5cm x 8 cm pieces of cotton fabric (on the grain) and two 2.5cm x 5cm pieces of felt or batting.</li>
      <li>Center each felt piece on a piece of cotton and sew a basting stitch down the middle to keep the felt pieces in place.</li>
      <li>For each pair of cotton pieces, place wrong sides together and pin (the felt should be facing out).</li>
      <li>Stitch around the edge using a machine, leaving one of the short ends open and being careful not to stitch over the felt. </li>
      <li>Flip each piece inside out.</li>
      <li>Fold the edges of the open end in and stitch to close.</li>
      </ol></p>

    <p>Attach to the gloves:<ol>
      <li>Put on each glove and carefully mark with pins where the corners of your square pillow will need to be placed.</li>
      <li>Remove glove and stretch over a piece of cardboard or a cup and pin the pillow in place.</li>
      <li>Hand stitch the pillow to the glove using the <a href="https://www.youtube.com/watch?v=rZ_wVC84UmM">backstitch</a>.</li>
      </ol></p>
    </div>
    <div class="col-sm-6">

      <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
<div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
  data-link="https://photos.app.goo.gl/JzywDGrCG3QD2Ltu6"
  data-title="ps70 - Microcontroller Pillow"
  data-description="5 new photos added to shared album">
  <object data="https://lh3.googleusercontent.com/2i7M-ay4qxwkDtbfgJF_9l6gmJAYjLoXUsqtYeGtchJmRgH8ALtySVzDtdkKjsw4ufplw2PdHpNp_0p3iToBLnyfzZNBpYvJbIEArUa1NCRK0nG2BiShdzJfkcYyM6-pRfx_fxAfibY=w1920-h1080"></object>
  <object data="https://lh3.googleusercontent.com/VC6FMSTYiILtb0eoBytNXDOXp7Jzrnia2oy70eA84kyYcbfI6dECK_pzjRx4RxeFVEt7KU_bp2gMnXjkXm5WIi0EYczZ6pHed0S2Os6DaY4MPvSLZoGHK1-JciofXWZpF5pbohiLgR4=w1920-h1080"></object>
  <object data="https://lh3.googleusercontent.com/z4SPuKsyFnjcN0GdKBfU2ZkPknyKjAkuLrkxTC9Ao7aOMcPogKMbGf3cgHbTXLmppso6XhrKT-l6uE8_Et7ah6GaSHsHf0JLhKH0RY7fCg8Rpv70SJ9wvtXcLoDtAiwr0ovupFajZ9Y=w1920-h1080"></object>
  <object data="https://lh3.googleusercontent.com/w-LsvKqD8mVxb1wnG4BOo2EdeKBZjUep-_of-b6DUTCWOGONDKNMKTvvJIPbspqVdfAPCvC_YD9Url53kMPDVygdl7SaJ4bc-6bLwkYPK_yGn60g7_ewZ5Qf_avxzvtTku9d5zEzthQ=w1920-h1080"></object>
  <object data="https://lh3.googleusercontent.com/VLmL0rddYzYvoegdE5Gd0QJeYRLz2K_MgFgQv0jwHy71XpidI65Xa1MB8D3Mw9mVPkIltncpHI6avy1AWV_SvglBe8fg1Ve7gZCtN6PXKiLqtfoD1SjFJNF7VtyYxsSAQUYoar2JBVg=w1920-h1080"></object>
</div>
</div>
</div>

  </div>
</div>
<BR>

<div class="row">
  <div class="col-sm-3">
    <p>CREATE THE WRISTBAND</p>
    </div>
  <div class="col-sm-9">
    <p>I actually did this step AFTER I assembled my circuitry onto my glove, which was a mistake. I ended up overhandling the glove and as I quickly discovered, it is not very durable. So if I did it over again, I would make the wristbands after attaching the micrcontroller "pillows." The wristband helps to keep the glove in place and can also serve as a future location for an external power supply.</p>
    <div class="row">
      <div class="col-sm-6">
    <p><ol>
      <li>Cut two pieces of cotton fabric 24.5cm by 9.5 cm each.</li>
      <li>Fold and press lengthwise, iron the crease. Open and lay flat, right side up.</li>
      <li>Cut 3 cm of hook-side velcro and position velcro 2 cm from the right edge and 1 cm from the upper edge.</li>
      <li>Cut 5.5 cm of loop-side velcro and place 1.5 cm from bottom left edge and 1.5 cm from bottom edge.</li>
      <li>Repeat for the other cuff, but reverse the positions of the velcro pieces.</li>
      <li>Sew each piece of velcro down.</li>
      <li>With wrong sides facing, pin and sew each wristband along the long edge and one short edge (0.25 inch seam allowance).</li>
      <li>Trim the corners and flip inside out. Press the seams.</li>
      <li>Fold in open end, press and topstitch to close.</li>
      <li>Pin the wristband to the cuff of the glove, lining up the hook-side velcro to the inside edge of the wrist opening.</li>
      <li>Hand stitch the wristband onto the glove using the backstitch.</li>
    </ol></p>
    </div>
    <div class="col-sm-6">
      <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
      <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
        data-link="https://photos.app.goo.gl/cHGjdBoYWuGdzmPd9"
        data-title="ps70 - Wristband"
        data-description="5 new photos added to shared album">
        <object data="https://lh3.googleusercontent.com/F8wzeuckaKGHod2q01DeTkBZ9tQC6VUbR1zOlxdfpjXDANe5ZZxl1DFi0EylluPQy_NROn2OmlR2LTw0UxcEzbHqtHwwkX-7gvQxhuI8Au7AyMUCdkEFI0Fdgw483P-RGBWKIWQ5CAM=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/3B-DP7utV_A1mznEmBBwiyYZ50RUxNBjFriFlscCYVdvsYBzOAZ100KnVcncyPZcqEhb6qIyYl7KQYG50uPTLkkikqWqebd26uJi5_j02FTqiTBpDL5EVvUhn4vjsg2sRTt8mr05FXw=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/2gUNTWiKcHiIqk6KDFomzoW2mnCfI4WM6NVvWD-aJ9-4aCJIeC-7XLK_SwtZSrrFHvCYLkDAftO_9gTNUFy6oDHfyw1bgZm1-DQYX6D-4YH3BTc6YreDHPtY3Giv95kb3m4zS9x6C5g=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/gahSeOEzuyYMtUzPW9WGyz1OHw1LggnBY6ZxOuHO0pK-6u6dk7iKtA1wsY31gbWt9SMBE9uch-5Fnf7tP_Uqpm1MA6iNaRl3qCSWLglZme1QSqVVTttf4YeIrFloHmHKxpmahXpfk-0=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/4siQxsteT43O-U3UA8FhVSIjcFTQShvD6FPD8FmrSIYV70oP9ab8PcnpSLINqHwM6j58dMyXOJ4Onj5vzhKEtfgQbSLm5WsiSnapQrj4cs-Ih0GHjDeuspXBgxLBWnGYhTeeTBuTVxg=w1920-h1080"></object>
      </div>
    </div>
  </div>

  </div>
</div>

</div>

<!-- FABRICATION -- CIRCUITRY -->
<div class="container-fluid bg-7">
  <p><h3><b>CIRCUITRY</b></h3></p>
<div class="row">
  <div class="col-sm-3">
    <p>CREATE THE FLEX SENSORS</p>
    </div>
  <div class="col-sm-9">
    <p>I followed <a href="https://aspartate.github.io/personal_website/blog/week-11-usb-communication/">Andrew's method for creating a DIY flex sensor</a>. Here is what I did:</p>
    <div class="row">
      <div class="col-sm-6">
      <ol>
        <li>Cut 2 pieces of velostate 7.5cm by 0.8cm.</li>
        <li>Cut 4 pieces of aluminum foil 7.3cm by 0.6cm.</li>
        <li>Cut 4 lengths of 30AWG wire and trim off about 1 cm of insulation. Make sure there is enough length of wire to experiment with later.</li>
        <li>Pull off a piece of gaffer tape and carefully place one wire on the tape with a piece of aluminum foil over it.</li>
        <li>Place the velostat over the aluminum foil and wire. Because it is slightly larger than the foil, it will adhere to the tape and completely cover the aluminum foil.</li>
        <li>Trim the tap around the foil and velostat, leaving a few millimeters around the edge.</li>
        <li>This is the tricky part, carefully place another piece of foil over the velostat, and a second wire to the aluminum foil. Holding this with one hand, take the trimmed off piece of gaffer tape and place it edge to edge at the point where the wires meet the sensor.</li>
        <li>Carefully and incrementally press the tape down, ensuring that the aluminum foil does not move around.</li>
        <li>Trim off the excess tape. Leave some room at the non-wired end of the sensor so that it can be sewn down to the glove to prevent slippage.</li>
      </ol>
      </div>
      <div class="col-sm-6">
        <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
        <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
          data-link="https://photos.app.goo.gl/7aBgMvVpP96LAWhM6"
          data-title="ps70 - Flex Sensors"
          data-description="8 new photos added to shared album">
          <object data="https://lh3.googleusercontent.com/hFqPvT3Uv_YSbjr_nZcYZL1mi6PlmpqeBXMhn9R5ba5mbvvPLhboiSYjYHRbJulQaVnKitUaqkTzk1TCvoK3SyvThK-zXsLjZ_jIA_cXMXNpDOwwjuJ6A2TI9mBfK3lXi23c0QWhsPU=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/VbEo4kHXepTXjUyWS51iAMznM0mfmTTZClDOnLqo6mfPF0dNOnrYa0azyBZ_UHo0Tai6qvn2JHTFKUQyliTJN54zgqn1kY6lQ5VD2QtyytxFCg0TJmt_O_82y4T_JvwbMFetcQ6C8Mo=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/ZfcK60w_4ikOjz8Y5tPm3ASRnk7NpfH3jhItYFWU8nQCJP2D5vWT_nBB6wKA4oVf_Z1KYLBvjWS4XdQt1Id2EPxC1UCAk0PgTT-lnhNOtSIalitzVyKufoIdmGLO3JLwuYqmOt5jIH0=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/vOHGh7QMrgcY3wrVXh4P4zKKi_wbylv3hzB0xHhwzS650LnLrkbkUKgnIVAg4dDGYdPMeOXmk4WP0vLPCfFqN01lt0BmzzJToCsEk6OgaHDUorwlwMjOikSNkONC1GrJoOXxNBnwR4Y=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/DTVoVXrgxOEwqRzWgji-HAlI0f5lX1hYZL9rzn2MtTVt8AwQlhJ3JnaSvGuWov5A95iwI8sOIjehv1BhUMYo1hAls4s7lFFiNpIWoZvIcBiYlp8b4DInj5MlHggYzAtzh9Cd8ts8zoM=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/eHghwIfDyjiKuU3jmKFlMzZdN1B3zOdrrbrpEXGT6YgVgyfsWFtk90snLvmAUTlNHhf4lG38G6oy0VnEd9kHMiwwHqky9bY_heyEjH0T9dZf8HDFgQFs5KMt9mI7BXeP5ayxY1wtVtI=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/BpdOpFO0Ad4Vv3REW6Qn9YznxL-nAiR3nxxJsytBM-ImnlXL3gMCXiacB0BStWs6MP6zxXkR2qG5lOAmcWug92Cxjh-pvBMvobsYhK6H9lmuMvrILkhSg6ez73Vwpw7mWdQffmS_DlE=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/cQF52k2lBOyw01mT2O4jYwi4u4G6PuIxmi1KhYUZ14LBRbqhqn4ty9Y2OL3wvDLLCp4_zT9DVvw_CULgUZK5AmoBUcOjxKChm4zvguSk2KvKp8JfaVyZLqlws83ko2l06H5b8WUhbMc=w1920-h1080"></object>
        </div>
      </div>

  </div>
</div>
</div>
<br>

<div class="row">
  <div class="col-sm-3">
    <p>ARRANGE THE CIRCUITRY AND TEST</p>
    <!-- NEED TO MAKE DIAGRAMS -->
    </div>
  <div class="col-sm-9">
    <p>In creating a wearable, it's important to keep things small, light, and durable. The built-in IMU and many other sensors on the Nano 33 BLE Sense made things much easier because I had many fewer components to connect. This meant that the left hand glove essentially consisted of the microcontroller. The right hand glove, however, required some more complex planning to connect the tap sensors and the flex sensors in a small space.</p>
    <p>After testing the circuits for the tap sensor and the flex sensors separately, I diagrammed the total circuit plan and then tested the connections out using hook test leads and a breadboard.</p>
    <div class="row">
      <div class="col-sm-6">
        <p><img src="circuit.svg" class="img-responsive margin" style="600" height="400" alt="Circuit Diagram for the Right Hand Glove"></p>
      </div>
      <div class="col-sm-6">
        <p><<script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
        <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
          data-link="https://photos.app.goo.gl/s1kWaab1jxAcS2hp6"
          data-title="ps70 - Circuit Planning"
          data-description="5 new photos added to shared album">
          <object data="https://lh3.googleusercontent.com/HGLn-2qiW-Qe2j6_HXLHEbTkwvsSklH0-7DxYJcHIdCj2-hCdHgILH0Wz2_2oxphMWdWvNT-IK7sT8a6zhm__n9i96B4dSJh16sVVQMtaevpCHWGo1Zk3ZMs1XoGG7AAdI-sqfJl00U=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/JRLaORsilT6DhALieRQFk6a0dFs9U4xxm36ReuC1T9ViI2gPacEY9RiKwunv9QEF40r-1A8tMX0tah-I9NqFZ766RPkTotg0_Q7CRp6kkDJlRTre0za0f_LllYxLJ8HaEEEOx3xFgbQ=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/i0n6LIt_tW3UIDtw-EhDuUaEy6u5I_FlKAcw-zq2theyuCms_xG1s9DZYm8U5cp4_jBGVS2kT1djRzFTeGJv0NJ3X4LsTXNhw1Mu7zAF6WjtNSk9jEHq_Ob1N-sSSKKCjG7mSwd-w-o=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/pYVe40S0bLoh6S_YWeiUTCFoS0qFkX8C63t3m4pbY4bMrD_jIzV_r5y8FK-LhZC4c9vqEa8J_txxeajxq9aQPySdALxzaukcvfc0Fnd9G-CavCb6zmjMiunlKL2n5AATfMZhBIAy5y8=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/969HU6gsKabOpiKknHTGVxCcm8B_AiVrWHL88oI0Cc9M2knAye2ZL8kyI_MiQQ93p2g9h_ytsKkJ0S3sMVmDfSKcs4PZXJggpw8r9UUtsydlSB0ldhY05vECYxnq-PGflg6R65YMje4=w1920-h1080"></object>
        </div>

</p>
      </div>
    </div>
    </div>
  </div>
  <br>

<div class="row">
  <div class="col-sm-3">
    <p>SOLDER</p>
    </div>
  <div class="col-sm-9">
    <p>Testing out the circuitry also helped me prepare for soldering. I needed to solder many different connections, including to the microcontroller pins directly, 1:1 wire, 2:1 wire, and wire-resistor connections. I tried to limit all of my connections to a maximum of 2 splits per connection, with the exception of my triple voltage divider, where I soldered together all three resistors.</p>
    <p>I started with the microcontroller and moved outward, using longer wire than necessary and trimming as I made new connections based on how they would lay out on the glove. I used various labels to keep myself organized. I persistently forgot to put my pieces of heat shrink on to the wires before creating new Y-solder joins, which meant I redid a lot of my work.</p>
    <p>I rigged up a clothespin stage to help hold my various components in place during the soldering process.</p>
    <p>I read a couple of tutorials from Adafruit, notably their <a href="https://learn.adafruit.com/make-it-glow-how-to-solder-neopixels-a-beginners-guide/soldering-to-microcontrollers">beginner's guide to soldering</a> and their <a href="Adafruits guide to Excellence in Soldering">tips for excellence in soldering. I also perused some YouTube on soldering</a> before getting started to make sure that I would not destroy my microcontroller.</p>
    <div class="row">
      <div class="col-sm-6">
        <ol>
          <li>Solder single wires to GND, 3.3V, A2, A4, A6.</li>
          <li>Solder wires that will connect to finger tip pads on the index and middle fingers to resistors.</li>
          <li>Solder those resistors together and join to a third wire (this eventually will go to power).</li>
          <li>Solder one wire from each of the flex sensors together and solder to a third wire (this eventually will go to power).</li>
          <li>Solder a wire to a 1k Ohm resistor, three times. (you need three of these)</li>
          <li>Solder those three resistors together and connect to the wire soldered to GND.</li>
          <li>Match up the wires connected to A2, A4, and A6 pins to one each of the three voltage divider wires and solder.</li>
          <li>Solder the A4/Ground wire to the remaining index flex sensor wire and solder the A6/Ground wire to the remaining middle flex sensor wire.</li>
          <li>Solder the A2/Ground wire to a third wire that will connect to the thumb pad.</li>
          <li>Test your connections.</li>
          <li>Blow dry your heat shrink. Remember to put the heat shrink on in the first place; don't blow dry the microcontroller; and don't blow dry over a silicon mat -- it will warp it (RIP silicon quilting mat).</li>
        </ol>

      </div>
      <div class="col-sm-6">
        <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
        <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
          data-link="https://photos.app.goo.gl/EnNeQzYPY9omi1XE9"
          data-title="ps70 - Soldering"
          data-description="8 new photos added to shared album">
          <object data="https://lh3.googleusercontent.com/VkFRgLFOlT9HzWvFT2hKUfAjvgdcj-XXTvtHF_mprTu2qESMS4kAiNrWAHScviD7XuIAcJXP9tmTZ2GX1TXx6f4NM7f3VBis8kqpYseQ3aZsmII5pImdVgQHxWany2zO0Ga71k_M88o=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/e1ipWr-fvWCFxSDhPJZu4qWbjT2q6Ip7YW64GsFoKd_c1hIGTfNjnPOa9-lYFdvxjuvf-WSOpLqCzqwbjkMlxW09--IwPGpSebe5Me-s26p9gJBvxqyrNOfH3ae2TjIc52j1FoHSaNc=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/lnrpFb_IilZmRpUu3AUGikMm7l4odF2gCYDRP5b8O4vXgevcpAGYscqsQIV3Vq-9rMLfM0ecANO_VJB81zsS20M9xjtwSCTP8gOcXu05s38FPe2RcI-OMNr6qQFVuTUiFS9KZt6UZz4=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/wCG3Xg51rDGTtQqHbyr1AP6G8BJj0hk2ytpMRRvMpmloVjfg-P1ypa22B2QfBI6Tj9S3NJtzx4BQCoNJ2xkRkSKlpdgSnGu3n5_VRDLPZajQ5MDkQAxSDsjCKeRMFQcydUHEHIAEve8=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/Uckhp75zRRJIkVXGn4HalrCwVyzYSUASZxHVL_z4ktN_8DiGozLZjcXCpBjQvM1JWOpKxjfVtnKTM0Cb43Go88q3fVhwnyeNgDAPNJihoMwX2wOUYpdI3oQWWb4BlhHm01HXmwgrcJE=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/u6S_9jUeLiGF_eyd3z842JIg1vgwoP5zv-WAg17l7TCBhIBOackAHrzVIkaoSGiblu9dP3LzdIhMriBBy0EUhlRuSlChTzzCwuNFdAbwK2d-bovwiJJoE3kLXZGaRMFD4GgtK6fHlBM=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/X0AYvG1q98Obvar9jJU5T_Rr3v9Dy1PR1KuJbjcaT2GCtuldipSwaT0TwsdNypwoJ_J2xSUK2Fc4-8meDCPQt-95Pn6NwTwV1aROXjnsJVrayDCzYmIZB9q2XEmykEeEo3dG-CiJkVI=w1920-h1080"></object>
          <object data="https://lh3.googleusercontent.com/HckQjjoMCHSlU3JMJ29w7RnB4k4bd9Y1jk-jXCpo2yq9YmkZMNsEzwbOnlVB1YJ1JPbGDOS5rguwyAko_hcJ1Zpwc4XD-TfKNNrh_KJ13iseD1GnnIImzKBHqj1aX0lnK2Ez-LyGB0k=w1920-h1080"></object>
        </div>

      </div>
    </div>

  </div>
</div>
<br>

<div class="row">
  <div class="col-sm-3">
    <p>ATTACH CIRCUITRY TO GLOVE</p>
    </div>
  <div class="col-sm-9">
    <p>Having mapped out the circuitry multiple times, it was fairly clear to me how the circuitry would lay on the glove. I started by sewing the microcontroller onto its little pillow for both the right and left hand gloves. The microcontroller has four corner holes that were very useful for this task. In the future, I may try using eyelet hooks to attach the microcontroller to make it easier to remove when I need to repairs.</p>
    <div class="row">
    <div class="col-sm-6">
      <p>I then inserted the flex sensors into the channels that I had sewed into the glove and tacked them down to the tips of the glove. I later also tacked the bottom portion of the flex sensor as the sensors were inching up the finger during use.</p>
      <p>I then sewed the wires to the conductive pads by creating a little loop of exposed wire at the end of each and sewing that with conductive thread.</p>
      <p>To finish, I tacked down the wires to keep them from flying all over the place. This ended up being not quite enough and I continually revised where I had sewed down the wires to balance flexibility with stability.</p>
    </div>
    <div class="col-sm-6">
       <script src="https://cdn.jsdelivr.net/npm/publicalbum@latest/embed-ui.min.js" async></script>
      <div class="pa-gallery-player-widget" style="width:100%; height:480px; display:none;"
        data-link="https://photos.app.goo.gl/9SqJZyvP3xvTLC469"
        data-title="ps70 - Assembly"
        data-description="6 new photos added to shared album">
        <object data="https://lh3.googleusercontent.com/WJaSjG2fVN7hnH3lN1qNNO2fW13FvdlWWJlAbMVRngJtnh75Pjd219P4pZBRP_1a5v1NkEP18RulEvS-yMa7B0n2_sdURaIjeu9sDKGZwFW1Uu6kIB19u2F3rZBCrBYt7s_M0kx2M-U=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/XWDVdW5F8TC08D98TospY6ZW-_5SVLb3s7h9EFXgiOvLRT1xA3Lht6p6-ULYfJN0xCJf_kUau3EyohLdZ6wXLno94AToloRsoqpitwiDQigb9HMhMhxNPlcinS7SEZXrPjnz3Mix2yQ=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/uPUgc3KS5cJh3MsRHnkrSg87MmcqzBbIDabtsiAAVjnS_FfN0D8mODw3GaSIPczlGZA8Y9XYc9bsLl3dEr9zcgy0Z8O0CejqaEp6IcEPRFrbPhjcmxrSaJg0uAmWVbkPY1uCZbsG3PQ=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/e2N8fl_8YOLT_5BtD6b5UqnU8xynvsuTYRCx-PWUzTRrc4ZO56JBwnX1UgBCskMT884HYgCvyllQphmKgP6hAsjGf1o7ujrsQswulgTlKQvI4UGX546KoWkV8rp2bn2671QoTquXUHY=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/3ZHEjOcYg8fVRVtDMiecMWIuW_Nn_QGYMtL4GbecS7sHIwLSC5rtMhzMon8ce9urHfrrD-zhTdbPLqMIFZlKGxaMTnbkIxqmiRRjVxufo1F_QkqYnUuVNOTxJeW-WdKHkwVwrM2Eqh8=w1920-h1080"></object>
        <object data="https://lh3.googleusercontent.com/CGpCbQPDBpEZjfj5aDLLpmTOIrQ7L8BuNu0Ls4iAtQfspugeRddkRu2U45qAepRoxSl209e1eVwjafLwMZrGoAZRzyLJ0O-XndCCS0ypS77OtBIfCJucIO1_d_TrW5G5j_f7SZU1rIc=w1920-h1080"></object>
      </div>

      </div>
    </div>

  </div>
</div>
</div>

<!-- FABRICATION -- CODE -->
<div class="container-fluid bg-2">
<div class="row">
  <div class="col-sm-3">
    <p>CODING THE MICROCONTROLLERS</p>
    </div>
  <div class="col-sm-9">
    <p>I needed two sets of code for each glove. The left hand glove needed to be coded for IMU and proximity information and the right hand glove needed to be coded for IMU, proximity, two flex sensors, and the tap circuit. I started by assembling each coding component separately and then I stitched the code together. Much of this code I adapted from Arduino IDE examples and various tutorials (see the Proposal & Development page for more information about that process).</p>
    
    <div class="row">
      <div class = "col-sm-3">
        <p><B>IMU CODE</B></p>
        <br>
        <p>I derived an IMU code sketch from this <a href="https://itp.nyu.edu/physcomp/labs/lab-serial-imu-output-to-p5-js/">ITP tutorial</a>. It uses a <a href="https://nitinjsanket.github.io/tutorials/attitudeest/madgwick">Madgwick filter</a> to calculate pitch, yaw, and roll out of the accelerometer and gyroscope data (here's the <a href="https://www.x-io.co.uk/res/doc/madgwick_internal_report.pdf">academic paper</a> explaining how it works).</p>
      </div>
      <div class = "col-sm-9">
        
        <p><pre><code class="language-arduino">
#include "Arduino_LSM9DS1.h"
#include "MadgwickAHRS.h"

//initalize a Madgwick filter:
Madgwick filter;
//sensor's sample rate is fixed at 114 Hz:
const float sensorRate = 114.00;

//values for orientation:
float roll = 0.0;
float pitch = 0.0;
float heading = 0.0;

void setup() {
  Serial.begin(9600);
  //attempt to start the IMU:
  if (!IMU.begin()) {
    Serial.println("Failed to initialize IMU");
    //stop here if you can't access the IMU:
    while(true);
    }

  //start the filter to run at the sample rate:
  filter.begin(sensorRate);

  }

void loop() {
  //values for acceleration and rotation:
  float xAcc, yAcc, zAcc;
  float xGyro, yGyro, zGyro;

  //check if the IMU is ready to read
  if(IMU.accelerationAvailable() && IMU.gyroscopeAvailable()) {
    //read accelerometer and gyrometer:
    IMU.readAcceleration(xAcc, yAcc, zAcc);
    IMU.readGyroscope(xGyro, yGyro, zGyro);

    //update the filter, which computes orientation:
    filter.updateIMU(xGyro, yGyro, zGyro, xAcc, yAcc, zAcc);

    //print the heading, pitch, and roll
    roll = filter.getRoll();
    pitch = filter.getPitch();
    heading = filter.getYaw();
    
    }

  //print the filter's results:
  Serial.print(heading);
  Serial.print(",");
  Serial.print(pitch);
  Serial.print(",");
  Serial.println(roll);
}
        </code></pre></p>
      </div>
    </div>
    <br>

    <div class="row">
      <div class = "col-sm-3">
        <p><b>PROXIMITY</b></p>
        <br>
        <p>I used the Arduino example sketch for the on-board gesture sensor in the Arduino Nano 33 BLE Sense. The proximity sensor is basically a fancy photoresistive sensor.</p>
      </div>
      <div class = "col-sm-9">
        
        <p><pre><code class="language-arduino">
/*
APDS9960 - Proximity Sensor

This example reads proximity data from the on-board APDS9960 sensor of the
Nano 33 BLE Sense and prints the proximity value to the Serial Monitor
every 100ms.

The circuit:
- Arduino Nano 33 BLE Sense

This example code is in the public domain.
*/

#include <Arduino_APDS9960.h>

void setup() {
  Serial.begin(9600);
  while (!Serial);

  if (!APDS.begin()) {
    Serial.println("Error initializing APDS9960 sensor!");
  }
}

void loop() {
  // check if a proximity reading is available
  if (APDS.proximityAvailable()) {
    // read the proximity
    // - 0   => close
    // - 255 => far
    // - -1  => error
    int proximity = APDS.readProximity();

    // print value to the Serial Monitor
    Serial.println(proximity);
  }

  // wait a bit before reading again
  delay(100);
}
        </code></pre></p>
      </div>
    </div>
    <br>

    <div class="row">
      <div class = "col-sm-3">
        <p><b>TAP CIRCUIT</b></p>
        <br>
        <p>The tap sensing code reads when the index finger, middle finger, both fingers, or neither finger were making contact with the glove. It does this using different resistor levels as thresholds.</p>
      </div>
      <div class = "col-sm-9">
        
        <p><pre><code class="language-arduino">
// circuit has two switches. "index" has a 4.7kOhm resistor, "middle" has a 10kOhm resistor; thumb has voltage divider of 1kOhm.

unsigned long startMillis;  //some global variables available anywhere in the program
unsigned long currentMillis;
const unsigned long period = 1000;  //the value is a number of milliseconds
int tap = A2;

void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  pinMode(tap, INPUT);
}

void loop() {
  // put your main code here, to run repeatedly:
  analogRead(tap);

  if(analogRead(tap) >= 200) {
    Serial.println("both");
  }

  else if(analogRead(tap) > 10 && analogRead(tap) < 100) {
    Serial.println("middle");
  }
  else if(analogRead(tap) < 200 && analogRead(tap) > 100) {
    Serial.println("index");
  }

  else if(analogRead(tap) < 10) {
    Serial.println("none");
  }
}
        </code></pre></p>
      </div>
    </div>

    <div class="row">
      <div class = "col-sm-3">
        <p><b>FLEX SENSORS</b></p>
        <br>
        <p>I used the flex sensor code that <a href="https://aspartate.github.io/personal_website/blog/week-11-usb-communication/">Andrew created</a> and built that out to read two flex sensor readings.</p>
      </div>
      <div class = "col-sm-9">
        
        <p><pre><code class="language-arduino">
const int flex1 = A4;
const int flex2 = A6;
int valflex1 = 0;
int valflex2 = 0;

void setup() {
  pinMode(flex1, INPUT);
  pinMode(flex2, INPUT);
  Serial.begin(9600);

}

void loop() {
 valflex1 = analogRead(flex1);
 valflex2 = analogRead(flex2);
 
 Serial.print(valflex1);
 Serial.print('\t');
 Serial.println(valflex2);

 delay(10);

}
        </code></pre></p>
      </div>
    </div>

<br>
    <div class="row">
      <div class = "col-sm-3">
        <p>Integrating the Code</p>
      </div>
      <div class = "col-sm-9">
        <p>Once I had the individual code pieces, it was not difficult to stitch them together.</p>
        <p><a href='./DanceGlove_Left.ino' download >Download the code for the left hand (IMU and Proximity)</a></p>
        <p><a href='./DanceGlove_Right.ino' download >Download the code for the right hand (IMU, Proximity, Tap, and Flex Sensors).</a></p>
      </div>
    </div>

  </div>
</div>

<br>

<div class="row">
  <div class="col-sm-3">
    <p>P5 COMMUNICATION USING BLE</p>
    </div>
  <div class="col-sm-9">
    <p>I built upon what I learned from <a href="../Week11/index11.html">Week 11</a> and <a href="../Week13/index13.html">Week 13</a> about using BLE to communicate between a microcontroller and p5. I decided to create code for p5 that focused entirely on the finger sensing, since I had already experimented with visualizing IMU data in those previous weeks. I modified the code that I had used before and after some frustrating debugging efforts, I was able to get the code to work. Like previously, I used the Chrome Web Server to load the p5 visualization from my own repo.</p>
    <p>Some important changes included changing the BLECharacteristic nature from "Float" to "Int" (this had to happen on both the Arduino sketch and the p5 sketch). I also eliminated the threshold reading that parsed the tap information. I did this so that I could get more interesting results in p5, plus p5 seemed to have issues understanding that bit of data as it was being sent.</p>
    <div class="row">
      <div class="col-sm-6">
        <p>Arduino Code</p>
        <p><pre><code class="language-arduino">
//This code collects data from the thumb/tab sensor,
// and the two flex sensors on the index and middle fingers.
// This code is meant for the right hand glove for the fingers

#include "ArduinoBLE.h" //include the BLE library

//values for tap sensor
const int tap = A2; // pin assigned to read taps via thumb
int valtap = 0;
//int tapID = 0;

//values for flex sensors
const int flex1 = A4; // pin assigned to read flexing of index finger
const int flex2 = A6; // pin assigned to read flexing of middle finger
int valflex1 = 0;
int valflex2 = 0;


//BLE Service
BLEService danceService("19B10010-E8F2-537E-4F6C-D104768A1214"); // create service
// a characteristic for each of the accelerometer values x, y, z
BLEIntCharacteristic valtapCharacteristic("19B10013-E8F2-537E-4F6C-D104768A1214", BLERead | BLENotify);
BLEIntCharacteristic valflex1Characteristic("19B10014-E8F2-537E-4F6C-D104768A1214", BLERead | BLENotify);
BLEIntCharacteristic valflex2Characteristic("19B10015-E8F2-537E-4F6C-D104768A1214", BLERead | BLENotify);

void setup() {
  Serial.begin(9600);

  //declare pin modes
  pinMode(tap, INPUT);
  pinMode(flex1, INPUT);
  pinMode(flex2, INPUT);

  //attempt to start BLE:
  if (!BLE.begin()) {
  Serial.println("starting BLE failed!");
  }

  BLE.setLocalName("DanceGlove_Fingers");
  BLE.setAdvertisedService(danceService);
  danceService.addCharacteristic(valtapCharacteristic);
  danceService.addCharacteristic(valflex1Characteristic);
  danceService.addCharacteristic(valflex2Characteristic);
 
  // add the service
  BLE.addService(danceService);

  // init all values to 0
  valtapCharacteristic.writeValue(0);
  valflex1Characteristic.writeValue(0);
  valflex2Characteristic.writeValue(0);

  BLE.advertise();
  Serial.println("Bluetooth device active, waiting for connections...");
 
}

void loop() {

  //poll for BLE events
  BLE.poll();
  

  //variable to tell if data was requested over serial;
  bool ping = false;

  //values for tap and flex sensors:
  valtap = analogRead(tap);
  valflex1 = analogRead(flex1);
  valflex2 = analogRead(flex2);


  //if you get a byte in the serial port, send latest data:
  while(Serial.available()) {
    Serial.read(); 
    ping = true; 
    }
  if (ping) {

    //print the results:
    Serial.print(valtap);
    Serial.print(",");
    Serial.print(valflex1);
    Serial.print(",");
    Serial.println(valflex2);

    }

  //update the characteristics if they have changed by more than 1:
    if (abs(valtapCharacteristic.value() - valtap) > 1) {
    valtapCharacteristic.writeValue(valtap);  
    }
    if (abs(valflex1Characteristic.value() - valflex1) > 1) {
    valflex1Characteristic.writeValue(valflex1);  
    }
    if (abs(valflex2Characteristic.value() - valflex2) > 1) {
    valflex2Characteristic.writeValue(valflex2);  
    }

}
        </code></pre></p>
      </div>
      <div class="col-sm-6">
        <p>p5 Sketch</p>
        <p><pre><code class="language-arduino">
// orientation variables, right
let valtap = 0.0;
let valflex1 = 0.0;
let valflex2 = 0.0;


/* initialize services we're looking for*/
//right
const serviceUuid = "19b10010-e8f2-537e-4f6c-d104768a1214";
const characteristicsUUID = {
  valtap: "19b10013-e8f2-537e-4f6c-d104768a1214",
  valflex1: "19b10014-e8f2-537e-4f6c-d104768a1214",
  valflex2: "19b10015-e8f2-537e-4f6c-d104768a1214",
}

// Declare BLE Object + characteristics
let myBLE;
let valtapCharacteristic;
let valflex1Characteristic;
let valflex2Characteristic;

function setup() {
  createCanvas(720, 500);
  myBLE = new p5ble();
  background("#FFF");
  // make a button and give it a callback
  const connectButton = createButton('Connect and Start Notifications')
  connectButton.mousePressed(connectAndStartNotify);
}

function connectAndStartNotify() {
  myBLE.connect(serviceUuid, gotCharacteristics);
  //myBLE.connect(gattServiceUuid, gattCharacteristics);
}

function gotCharacteristics(error, characteristics) {
  if (error) console.log('error: ', error);
  console.log(characteristics[1].uuid);
  for (let i = 0; i < characteristics.length; i++) {
    if (characteristics[i].uuid == characteristicsUUID.button) {
      buttonCharacteristic = characteristics[i];
      myBLE.startNotifications(buttonCharacteristic, handleButton);
    } 
    else if (characteristics[i].uuid == characteristicsUUID.valtap) {
      valtapCharacteristic = characteristics[i];
      myBLE.startNotifications(valtapCharacteristic, valtapCallback);
    } 
    else if (characteristics[i].uuid == characteristicsUUID.valflex1){
      valflex1Characteristic = characteristics[i];
      myBLE.startNotifications(valflex1Characteristic, valflex1Callback);
    } 
    else if (characteristics[i].uuid == characteristicsUUID.valflex2) {
      valflex2Characteristic = characteristics[i];
      myBLE.startNotifications(valflex2Characteristic, valflex2Callback);
    } 
    else {
      console.log("nothing");
    }
  }
}

function valtapCallback(data) {
  console.log('valtap: ', data)
  console.log(Number(data))
  valtap = data;
}

function valflex1Callback(data) {
  console.log('valflex1: ', data)
  valflex1 = data;
}

function valflex2Callback(data) {
  console.log('valflex2: ', data)
  valflex2 = data;
}

function draw() {
  // update the drawing:
  background(255); // set background to white
  
  //index finger triangle
  stroke(0);
  fill(valtap/2,valtap, 100);
  triangle(180,300,270,valflex1,360,300);

  //draw middle finger triangle
  stroke(0);
  fill(100, valtap, valtap/2);
  triangle(360,300,450,valflex2,540,300);
}
        </code></pre></p>
      </div>
    </div>
  </div>
</div>

</div>


<!--Data Visualization and Analysis -->
<div class="container-fluid bg-7">
  <p><h3><b>DATA VISUALIZATION & ANALYSIS</b></h3></p>
<div class="row">
  <div class="col-sm-3">
    <p>P5 VISUALIZATION & FINGER DATA</p>
  </div>
  <div class="col-sm-9">
    <div class="row">
      <div class="col-sm-6">
        <p>The p5 sketch and associated arduino code was designed to visualize the tap sensor and flex sensor data. The sketch draws two triangles. The height of the triangles responds to the value of a flex sensor with the left side triangle corresponding to the index finger flex sensor and the right side triangle corresponding to the middle finger. The colors of the triangles changes depending on the value of the tap sensor. There are many more visualization possibilities, but I did not have time to explore them because of the time I spent debugging the BLE communication, as well as on repairing the glove each time I used it.</p>
      </div>
      <div class="col-sm-6">
        <iframe src="https://giphy.com/embed/zTgYFdJCXNQTOdv6xZ" width="378" height="350" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/zTgYFdJCXNQTOdv6xZ"></a></p>
      </div>
    </div>
  </div>
</div>
<br>

<div class="row">
  <div class="col-sm-3">
    <p>IMU DATA ANALYSIS OF HAND DANCING</p>
  </div>
  <div class="col-sm-9">
    <p>I collected the pitch, yaw, and roll data using the serial monitor. Although the placement of the microcontroller on the gloves prevented the proximity sensor from being useful during hand dancing, it was very useful as a way of indicating when I needed to start paying attention to the data that was being sent from the gloves to the serial monitors. I simply covered the back of my hand while starting the serial monitor and again when unplugging the microcontroller from its power supply to indicate the beginning and end of the gesture sequence. For the data collection, I chose to start with a relatively basic Irish dance step called the "Bang Step." This step is composed of four basic movement motifs that can be clearly demarcated: "stamp", "step", "shuffle", "hop back". I collected data for each gesture individually, and also of the entire step choreography in sequence. By graphing the pitch, yaw, and roll information from both the right and left hands, I was able to identify various points in the data that recurred and recurred in pattern, and therefore I identified what each of the movement motifs were.</p>
    <p>An issue with parsing Irish step dancing choreography is that the movements elide together. The motifs of the "Bang Step" can be more or less clearly identified and the level of elision and thus modification of the gestures in context is low compared to other, more complex dance steps.</p>
    <div class="row">
      <div class="col-sm-6">
        <p><img src="stampchart.png" class="img-responsive margin" style="600" height="400" alt=""></p>
        <p><img src="shufflechart.png" class="img-responsive margin" style="600" height="400" alt=""></p>
      </div>
      <div class="col-sm-6">
        <p><img src="stepchart.png" class="img-responsive margin" style="600" height="400" alt=""></p>
        <p><img src="hopbackchart.png" class="img-responsive margin" style="600" height="400" alt=""></p>
      </div>
    </div>

  </div>
</div>

<!-- NEXT STEPS-->
<div class="container-fluid bg-2">
  <p><h4><b>NEXT STEPS</b></h4></p>
<div class="row">
  <div class="col-sm-3">
    <p>ISSUES TO BE RESOLVED</p>
    </div>
  <div class="col-sm-9">
    <p>Proximity sensor
      <ul>
      <li>While the proximity sensor was useful for collecting data for the machine learning component, it unfortunately did not provide the intended results for indicating which hand was “leading”. This was because of the microcontroller placement. One solution Ould be adjust the microcontroller placement on the glove to take advantage of this sensor. Another solution would be to add a photo resistive sensor to one of the fingers on each hand.</li>
      </ul></p>
    <p>Durability
      <ul>
      <li>Durability was a major issue for me throughout this process. Every time I used the right hand glove, I usually damaged it. The primary issue was the the 30AWG wire was breaking off just before the solder joins. I believe that this is a combination of issues. The first is that the 30AWG wire was significantly more flexible than the solder joints, thus it had much greater freedom of movement and this put strain on the wire at the join point. The second is that the wire was so thin that it cannot withstand much twisting. A third issue was that my heat shrink was not quite the right diameter to shrink to the 30AWG size. In the future, I would use stranded wire and a tighter insulation method (electrical tape seemed to work for my repairs, stabilizing the point where the wire meets the soldered joint).</li>
      <li>I also would use conductive fabric for the finger pads instead of conductive thread. Conductive fabric will create a smoother surface against which the fingers can move, and it also would be a more elegant approach.</li>
      </ul></p>
    <p>Rhythmicity and Duration
      <ul>
      <li>Particularly for the tapping feature, I had wanted to also produce a duration reading, such that whenever the state of the tapping changed, the microcontroller would produce a time differential. Unfortunately, I was never able to get that code sketch to work. <a href='./TapState_Function.ino' download >Download the code with the faulty function.</a></li>
      </ul></p>
  </div>
</div>

<div class="row">
  <div class="col-sm-3">
    <p>MACHINE LEARNING</p>
    </div>
  <div class="col-sm-9">
    <p>Unfortunately, I didn't have the time to learn about and experiment with a machine learning model. Though I had read through tutorials on using TensorFlow to create gesture recognition, I hadn't realized that those tutorials glossed over the part about actually using TensorFlow. I quickly realized taht this would have to be something I commit serious time to going forward as I could barely understand the directions for downloading the program. It will be exciting to see the possibilities!</p>
  </div>
</div>

<div class="row">
  <div class="col-sm-3">
    <p>DATA VISUALIZATION</p>
    </div>
  <div class="col-sm-9">
    <p>The visualization methods I utilized included p5 and Google Charts. Part of my hope was to use some visualization experimentation to see what I might learn from this movement data, as well as to find a way to express this movement information in a way that is legible to people who don't do Irish dance. I was surprised at how much I could glean from a basic line chart of IMU data (and to dust off some rusty chart editing skills)! My use of p5, however, was rudimentary, and I'd like to keep exploring the possibilities with that tool (or switch to a different visualization tool. </p>
  </div>
</div>

</div>

<div class="container-fluid bg-7">
  <p><h3><b>Other Resources</b></h3></p>
<div class="row">
  <p>I used a tool provided by <a href="https://www.publicalbum.org/blog/embedding-google-photos-albums">publicalbum.org</a> to embed a Google Photos Album onto this webpage. To create my circuit diagram, I used the aptly named <a href="https://www.circuit-diagram.org/">Circuit-Diagram.org</a>.
</div>
</div>


</body>
    

<!-- Footer -->
<footer class="container-fluid bg-4 text-center">
  <p>Bootstrap Theme Made By <a href="https://www.w3schools.com">www.w3schools.com</a></p> 
</footer>

</body>
</html>
